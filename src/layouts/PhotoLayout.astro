---
import Layout from "./Layout.astro";

const { isAlbumPage } = Astro.props;

import "../assets/stylesheets/reset.css";
---

<head>
    <script>
        const userTheme = localStorage.getItem("theme");
        const systemDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
        if (userTheme === "dark" || (!userTheme && systemDark)) {
          document.body.classList.add("dark");
        }
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>

<script>
    const btn = document.getElementById("#theme-toggle");
    if (btn) {
        btn.onclick = function () {
            document.body.classList.toggle("dark");
            const isDark = document.body.classList.contains("dark");
            localStorage.setItem("theme", isDark ? "dark" : "light");
        };
    } else {
        console.error("Theme toggle button not found");
    }
</script>

<style is:global>
    body {
        font-family: 'Helvetica Neue', Arial, Helvetica, Sans-Serif;
    }

    h1 {
        font-size: 2.2rem;
        font-family: Georgia, Times, 'Times New Roman', serif;
    }

    a {
        color: #000000;
    }

    .theme-toggle {
        padding: 0.5rem 0.5rem 0.3rem;
        background: none;
        border: none;
    }

    body.dark .theme-toggle {
        filter: invert();
    }

    body.dark {
        background-color: #000;
        color: #fefefe;

        a {
            color: #fefefe;
        }
    }

    article {
        max-width: 1024px;
        padding: 4rem;
        @media (max-width: 1024px) {
          padding: 1rem;
        }
    }

    h1 {
        margin: 0;
    }

    h1 a {
        font-size: 0.5em;
    }

    a {
        color:#000000;
    }

    a:visited {
        color: #000000;
    }
</style>

<style>
    .flex {
        display: flex;
        align-items: center;
        gap: 1rem;
        justify-content: space-between;
    }

    .flex-wrap {
        flex-wrap: wrap;
    }
</style>

<Layout title={Astro.props.title}>
    <article>
        <header class="flex">
            <div class="flex flex-wrap">
                <h1>Odin&rsquo;s&nbsp;Photography{isAlbumPage && (<>&mdash;{Astro.props.title}</>)}</h1>
                {isAlbumPage && (<a href="/photos">&larr;&nbsp;albums</a>)}
            </div>

            <button
                id="#theme-toggle"
                class="theme-toggle"
                type="button"
                title="Toggle theme"
                aria-label="Toggle theme"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    aria-hidden="true"
                    width="1em"
                    height="1em"
                    fill="#000000"
                    viewBox="0 0 32 32"
                >
                    <path d="M16 .5C7.4.5.5 7.4.5 16S7.4 31.5 16 31.5 31.5 24.6 31.5 16 24.6.5 16 .5zm0 28.1V3.4C23 3.4 28.6 9 28.6 16S23 28.6 16 28.6z" />
                </svg>
            </button>
        </header>

        <slot/>
    </article>
</Layout>
