---
import Layout from "./Layout.astro";

const { isAlbumPage } = Astro.props;
---

<head>
    <script>
        const userTheme = localStorage.getItem("theme");
        const systemDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
        if (userTheme === "dark" || (!userTheme && systemDark)) {
          document.body.classList.add("dark");
        }
    </script>
</head>

<script>
    const btn = document.getElementById("#theme-toggle");
    if (btn) {
        btn.onclick = function () {
            document.body.classList.toggle("dark");
            const isDark = document.body.classList.contains("dark");
            localStorage.setItem("theme", isDark ? "dark" : "light");
        };
    }
</script>

<style>
    .theme-toggle {
        padding: 0.5rem 0.5rem 0.3rem;
        background: none;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        z-index: 1000;
    }

    body.dark .theme-toggle {
        filter: invert()
    }

    body.dark {
        background-color: #000;
        color: rgba(255, 255, 255, 0.8);

        a {
            color: rgba(255, 255, 255, 0.8);
        }
    }

    article {
        max-width: 1024px;
        padding: 4rem;
        @media (max-width: 1024px) {
          padding: 1rem;
        }
    }

    h1 {
        margin: 0;
    }

    h1 a {
        font-size: 0.5em;
    }

    h1 a:hover {
        text-decoration: underline;
    }

    .flex {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .flex-grow {
        flex-grow: 1;
    }
</style>

<Layout title={Astro.props.title}>
    <article>
        <header class="flex">
            <div class="flex">
                <h1>Odin's Photography{isAlbumPage && (<>&mdash;{Astro.props.title}</>)}</h1>
                {isAlbumPage && (<a href="/photos">&larr; albums</a>)}
            </div>

            <div class="flex-grow"></div>

            <button
                id="#theme-toggle"
                class="theme-toggle"
                type="button"
                title="Toggle theme"
                aria-label="Toggle theme"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    aria-hidden="true"
                    width="1em"
                    height="1em"
                    fill="currentColor"
                    viewBox="0 0 32 32"
                >
                    <path d="M16 .5C7.4.5.5 7.4.5 16S7.4 31.5 16 31.5 31.5 24.6 31.5 16 24.6.5 16 .5zm0 28.1V3.4C23 3.4 28.6 9 28.6 16S23 28.6 16 28.6z" />
                </svg>
            </button>
        </header>

        <slot/>
    </article>
</Layout>
