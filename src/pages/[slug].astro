---
import { getCollection, render } from "astro:content";
import type { GetStaticPaths, InferGetStaticPropsType } from "astro";
import { getPostDate } from "../indexHelpers";
import MainLayout from "../layouts/MainLayout.astro";

export const getStaticPaths = (async () => {
  const posts = await getCollection("posts");
  return posts.map((post) => {
    return {
      params: { slug: post.id },
      props: { post },
    };
  });
}) satisfies GetStaticPaths;

const { post } = Astro.props;

const date = getPostDate(post.filePath);
const { Content } = await render(post);
---

<MainLayout title={post.data.title}>
  <article class=post>
    <header>
      <h1>{post.data.title}</h1>
      <div class=meta>
        <time>Posted on {date.toISOString().split("T")[0]}</time>
        <span>by Odin Dutton</span>
      </div>
    </header>

    <Content />
  </article>
</MainLayout>